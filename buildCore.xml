<?xml version="1.0" encoding="UTF-8"?>
<project name="l2jserver" default="BUILD" basedir=".">

    <!-- Define properties related to source and library directories -->
    <property name="src" location="src"/>
    <property name="src-lib" location="lib"/>

	<echo message="=== Starting the compilation process ==="/>
    <!-- Define properties related to build directories -->
    <property name="build" location="build"/>
    <property name="build.classes" location="${build}/classes"/>
    <property name="build.dist" location="${build}/dist"/>
    <property name="build.dist.login" location="${build.dist}/loginserver"/>
    <property name="build.dist.login.lib" location="${build.dist.login}/lib"/>
    <property name="build.dist.game" location="${build.dist}/gameserver"/>
    <property name="build.dist.game.lib" location="${build.dist.game}/lib"/>

    <!-- Define the classpath -->
    <path id="classpath">
        <fileset dir="${src-lib}">
            <include name="**/*.jar"/>
        </fileset>
    </path>

    <!-- Main compilation and JAR generation task -->
    <target name="BUILD" description="Generate core JAR into 'build-core' folder">
        <!-- Delete existing directories and files -->
        <echo>Checking existing directories and files...</echo>
        <delete dir="${build.classes}"/>
        <delete file="${build}/libs/l2jserver.jar"/>

        <!-- Create necessary directories -->
        <echo>Creating necessary directories...</echo>
        <mkdir dir="${build}"/>
        <mkdir dir="${build.classes}"/>

        <!-- Compile source code -->
        <echo>Compiling source code...</echo>
        <javac destdir="${build.classes}" includeantruntime="false"
            optimize="on" debug="on" source="21" target="21" encoding="UTF-8" nowarn="off">
            <src path="${src}"/>
            <classpath refid="classpath"/>
        </javac>

        <!-- Copy specific service files -->
        <echo>Copying specific service files...</echo>
        <copy todir="${build.classes}/META-INF/services">
            <fileset dir="${src}/META-INF/services"/>
        </copy>

        <!-- Create JAR file -->
        <echo>Creating JAR file...</echo>
        <jar destfile="${build}/libs/l2jserver.jar">
            <fileset dir="${build.classes}"/>
        </jar>
        
        <!-- Delete temporary class directory -->
        <echo>Cleaning up temporary class directory...</echo>
        <delete dir="${build.classes}"/>

        <!-- Display progress messages -->
    	<echo message="Checking the entire Progress."/>
        <echo message="Progress: [==          ] 20%"/>
        <sleep seconds="1"/>
        <echo message="Progress: [====        ] 40%"/>
        <sleep seconds="1"/>
        <echo message="Progress: [======      ] 60%"/>
        <sleep seconds="1"/>
        <echo message="Progress: [========    ] 80%"/>
        <sleep seconds="1"/>
        <echo message="Progress: [==========  ] 100%"/>
    	<echo message="Build saved with success..."/>
    	
        <echo message="=== Compilation process completed ==="/>
    </target>

</project>
